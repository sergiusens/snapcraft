summary: Cross-compile a Kbuild snap

systems:
  - ubuntu-16.04-amd64
  - ubuntu-18.04-amd64

environment:
  SNAP_DIR: ../snaps/kbuild-hello

restore: |
  cd "$SNAP_DIR"
  snapcraft clean
  rm -f ./*.snap

execute: |
  cd "$SNAP_DIR"
  snapcraft stage --target-arch=armhf
  file stage/bin/myapp | MATCH ",\s*ARM\s*,"
