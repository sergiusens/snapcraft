summary: Cross-compile Go snaps using cgo

systems:
  - ubuntu-16.04-amd64
  - ubuntu-18.04-amd64

environment:
  SNAP_DIR: ../snaps/go-cgo

restore: |
  cd "$SNAP_DIR"
  snapcraft clean
  rm -f ./*.snap

execute: |
  cd "$SNAP_DIR"
  snapcraft stage --target-arch=armhf
  file stage/bin/go-cgo | MATCH ",\s*ARM\s*,"
